name: unvanquished-alpo
title: Unvanquished
base: core24
version: 'latest'
summary: Real-time strategy game where aliens and humans fight for their survival
description: |
  Unvanquished is a free, open-source first-person strategy game shooter, pitting technologically advanced human soldiers against hordes of highly adaptable aliens. Players can choose from either team, providing for an entirely different experience on both sides, as humans focus on long-range firepower while aliens rely instead on quick movement and stealth. The goal of each match is to destroy the enemy base, preventing members of the opposing team from spawning. Upgrades for both teams are earned by a combination of individual performance and team map control, unlocking access to more powerful weapons and equipment for the humans, and larger, more ferocious forms for the aliens.

grade: stable
confinement: strict

icon: snap/gui/unvanquished.png
website: https://unvanquished.net/
contact: https://github.com/alponaut/unvanquished-snap-unofficial/issues
issues: https://github.com/alponaut/unvanquished-snap-unofficial/issues
source-code: https://github.com/alponaut/unvanquished-snap-unofficial/

platforms:
  amd64:
    build-on: [amd64]
    build-for: [amd64]

apps:
  unvanquished:
    extensions: [gnome]
    command: unvanquished
    environment:
      HOME: $SNAP_USER_COMMON
      XDG_DATA_HOME: $SNAP_USER_COMMON/.local/share
      QT_QPA_PLATFORM: xcb
    plugs:
      - network
      - network-bind
      - audio-playback
      - joystick
      - shmem

plugs:
  shmem:
    interface: shared-memory
    private: true

parts:
  unvanquished:
    plugin: dump
    source: ./local
    stage-packages:
      - zlib1g
      - liblua5.3-0
      - libopenal1
      - libopusfile0
      - libncurses6
      - libncursesw6
      - wget
      - unzip
  
  gpu-2404:
    after: [unvanquished]
    source: https://github.com/canonical/gpu-snap.git
    plugin: dump
    override-prime: |
      craftctl default
      ${CRAFT_PART_SRC}/bin/gpu-2404-cleanup mesa-2404
      # Workaround for https://bugs.launchpad.net/snapd/+bug/2055273
      mkdir -p "${CRAFT_PRIME}/gpu-2404"
    prime:
    - bin/gpu-2404-wrapper
